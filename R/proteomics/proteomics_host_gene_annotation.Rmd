---
title: "gene_annotation_proteo_host"
author: "HCW"
date: "5/5/2020"
output: html_document
---

```{r}
gene_annotation_raw <- read.delim("~/R/pantherGeneList.txt",header=F)
colnames(gene_annotation_raw) <- c("System_uniprot_id","Accession","Ortholog","Description","Annotation","Gene_source")

actin_list <- gene_annotation_raw$Annotation[grepl("actin",gene_annotation_raw$Annotation)] %>% unique %>% droplevels
enzyme_list <- gene_annotation_raw$Annotation[grepl("ase",gene_annotation_raw$Annotation)] %>% unique %>% droplevels
immunoglobulin_list <- gene_annotation_raw$Annotation[grepl("immunoglobulin",gene_annotation_raw$Annotation)] %>% unique %>% droplevels
pigr_list <- gene_annotation_raw$Description[grepl("POLYMERIC IMMUNOGLOBULIN RECEPTOR",gene_annotation_raw$Description)] %>% unique %>% droplevels
defensin_list <- gene_annotation_raw$Description[grepl("DEFENSIN",gene_annotation_raw$Description)] %>% unique %>% droplevels

struc_proteins <- c("extracellular matrix structural protein", "cadherin", "cell adhesion molecule") %>% paste(collapse="|")
struc_proteins_list <- gene_annotation_raw$Annotation[grepl(struc_proteins,gene_annotation_raw$Annotation)]  %>% unique %>% droplevels()

gene_proteins <- c("histone", "homeodomain transcription factor"," ribosomal protein", "translation factor", "translation elongation factor") %>% paste(collapse="|")
gene_proteins_list <- gene_annotation_raw$Annotation[grepl(gene_proteins,gene_annotation_raw$Annotation)]  %>% unique %>% droplevels()


immuno_proteins <- c("major histocompatibility complex protein", "antimicrobial response protein") %>% paste(collapse="|")
immuno_proteins_list <- gene_annotation_raw$Annotation[grepl(immuno_proteins,gene_annotation_raw$Annotation)]  %>% unique %>% droplevels()

gene_annotation <- gene_annotation_raw %>% 
  mutate(annot_bin=ifelse(Annotation %in% actin_list,"Actin",
         ifelse(Annotation %in% enzyme_list,"Enzyme",
                ifelse(Annotation %in% struc_proteins_list,"Structural_protein",
                       ifelse(Annotation %in% gene_proteins,"Gene_protein",
                              ifelse(Annotation %in% immunoglobulin_list | Description %in% pigr_list,"Immunoglobulin",
                                     ifelse(Annotation %in% immuno_proteins_list,"Immuno_protein",
                                            ifelse(Description %in% defensin_list,"Defensin","Other"))))))))

save_path_proteomics <- "../../data/proteomics/cleaned/"
proteo_host_filt <- readRDS(file = paste(save_path_proteomics, "proteo_host_filt.rds", sep = ""))

proteo_host_filt_annotated <- proteo_host_filt %>% 
  gather(key=Accession,value=Result,-Participant,-Group,-Timepoint) %>% 
  right_join(select(gene_annotation,Accession,Description,annot_bin),.)
```

